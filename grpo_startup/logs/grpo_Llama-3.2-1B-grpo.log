[2025-05-09 17:06:14,135] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
The new embeddings will be initialized from a multivariate normal distribution that has old embeddings' mean and covariance. As described in this article: https://nlp.stanford.edu/~johnhew/vocab-expansion.html. To disable this, use `mean_resizing=False`
wandb: WARNING The `run_name` is currently set to the same value as `TrainingArguments.output_dir`. If this was not intended, please specify a different run name by setting the `TrainingArguments.run_name` parameter.
wandb: Currently logged in as: kongyiji_is_coding (llm-edit) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.10
wandb: Run data is saved locally in /playpen/hongxuan/drug_repurpose/grpo_startup/wandb/run-20250509_170633-a7grd0t4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run /playpen/hongxuan/drug_repurpose/grpo_startup/models/Llama-3.2-1B-grpo
wandb: ‚≠êÔ∏è View project at https://wandb.ai/llm-edit/huggingface
wandb: üöÄ View run at https://wandb.ai/llm-edit/huggingface/runs/a7grd0t4
Using questions-only for training
  0%|          | 0/3240 [00:00<?, ?it/s]  0%|          | 1/3240 [00:04<3:47:44,  4.22s/it]  0%|          | 2/3240 [00:04<1:53:18,  2.10s/it]  0%|          | 3/3240 [00:05<1:18:58,  1.46s/it]  0%|          | 4/3240 [00:06<1:02:51,  1.17s/it]  0%|          | 5/3240 [00:06<53:57,  1.00s/it]    0%|          | 6/3240 [00:07<48:37,  1.11it/s]  0%|          | 7/3240 [00:08<45:12,  1.19it/s]  0%|          | 8/3240 [00:09<42:58,  1.25it/s]  0%|          | 9/3240 [00:12<1:24:24,  1.57s/it]  0%|          | 10/3240 [00:13<1:09:28,  1.29s/it]  0%|          | 11/3240 [00:13<59:12,  1.10s/it]    0%|          | 12/3240 [00:14<52:09,  1.03it/s]  0%|          | 13/3240 [00:15<47:15,  1.14it/s]  0%|          | 14/3240 [00:15<43:51,  1.23it/s]  0%|          | 15/3240 [00:16<41:28,  1.30it/s]  0%|          | 16/3240 [00:17<39:51,  1.35it/s]  1%|          | 17/3240 [00:20<1:23:54,  1.56s/it]  1%|          | 18/3240 [00:21<1:09:25,  1.29s/it]  1%|          | 19/3240 [00:21<59:16,  1.10s/it]    1%|          | 20/3240 [00:22<52:11,  1.03it/s]                                                   1%|          | 20/3240 [00:22<52:11,  1.03it/s]  1%|          | 21/3240 [00:23<47:19,  1.13it/s]  1%|          | 22/3240 [00:23<43:49,  1.22it/s]  1%|          | 23/3240 [00:24<41:18,  1.30it/s]  1%|          | 24/3240 [00:25<39:35,  1.35it/s]  1%|          | 25/3240 [00:28<1:23:38,  1.56s/it]  1%|          | 26/3240 [00:29<1:09:15,  1.29s/it]  1%|          | 27/3240 [00:29<59:14,  1.11s/it]    1%|          | 28/3240 [00:30<52:11,  1.03it/s]  1%|          | 29/3240 [00:31<47:15,  1.13it/s]  1%|          | 30/3240 [00:31<43:50,  1.22it/s]  1%|          | 31/3240 [00:32<41:24,  1.29it/s]  1%|          | 32/3240 [00:33<39:43,  1.35it/s]  1%|          | 33/3240 [00:36<1:25:04,  1.59s/it]  1%|          | 34/3240 [00:37<1:10:54,  1.33s/it]  1%|          | 35/3240 [00:38<1:01:02,  1.14s/it]  1%|          | 36/3240 [00:39<54:05,  1.01s/it]    1%|          | 37/3240 [00:39<49:11,  1.09it/s]  1%|          | 38/3240 [00:40<45:43,  1.17it/s]  1%|          | 39/3240 [00:41<43:15,  1.23it/s]  1%|          | 40/3240 [00:41<41:35,  1.28it/s]                                                   1%|          | 40/3240 [00:42<41:35,  1.28it/s]  1%|‚ñè         | 41/3240 [00:45<1:24:40,  1.59s/it]  1%|‚ñè         | 42/3240 [00:45<1:09:50,  1.31s/it]  1%|‚ñè         | 43/3240 [00:46<59:26,  1.12s/it]    1%|‚ñè         | 44/3240 [00:47<52:10,  1.02it/s]  1%|‚ñè         | 45/3240 [00:47<47:04,  1.13it/s]  1%|‚ñè         | 46/3240 [00:48<43:29,  1.22it/s]  1%|‚ñè         | 47/3240 [00:49<40:58,  1.30it/s]  1%|‚ñè         | 48/3240 [00:49<39:13,  1.36it/s]  2%|‚ñè         | 49/3240 [00:53<1:20:22,  1.51s/it]  2%|‚ñè         | 50/3240 [00:53<1:07:37,  1.27s/it]  2%|‚ñè         | 51/3240 [00:54<58:38,  1.10s/it]    2%|‚ñè         | 52/3240 [00:55<52:24,  1.01it/s]  2%|‚ñè         | 53/3240 [00:56<48:02,  1.11it/s]  2%|‚ñè         | 54/3240 [00:56<44:56,  1.18it/s]  2%|‚ñè         | 55/3240 [00:57<42:52,  1.24it/s]  2%|‚ñè         | 56/3240 [00:58<41:17,  1.29it/s]  2%|‚ñè         | 57/3240 [01:01<1:14:15,  1.40s/it]  2%|‚ñè         | 58/3240 [01:01<1:02:36,  1.18s/it]  2%|‚ñè         | 59/3240 [01:02<54:25,  1.03s/it]    2%|‚ñè         | 60/3240 [01:03<48:41,  1.09it/s]                                                   2%|‚ñè         | 60/3240 [01:03<48:41,  1.09it/s]  2%|‚ñè         | 61/3240 [01:03<44:45,  1.18it/s]  2%|‚ñè         | 62/3240 [01:04<41:55,  1.26it/s]  2%|‚ñè         | 63/3240 [01:05<39:58,  1.32it/s]  2%|‚ñè         | 64/3240 [01:05<38:33,  1.37it/s]  2%|‚ñè         | 65/3240 [01:08<1:17:25,  1.46s/it]  2%|‚ñè         | 66/3240 [01:09<1:04:41,  1.22s/it]  2%|‚ñè         | 67/3240 [01:10<55:48,  1.06s/it]    2%|‚ñè         | 68/3240 [01:10<49:35,  1.07it/s]  2%|‚ñè         | 69/3240 [01:11<45:15,  1.17it/s]  2%|‚ñè         | 70/3240 [01:12<42:11,  1.25it/s]  2%|‚ñè         | 71/3240 [01:12<40:03,  1.32it/s]  2%|‚ñè         | 72/3240 [01:13<38:34,  1.37it/s]  2%|‚ñè         | 73/3240 [01:16<1:19:11,  1.50s/it]  2%|‚ñè         | 74/3240 [01:17<1:06:02,  1.25s/it]  2%|‚ñè         | 75/3240 [01:18<56:49,  1.08s/it]    2%|‚ñè         | 76/3240 [01:18<50:22,  1.05it/s]  2%|‚ñè         | 77/3240 [01:19<45:53,  1.15it/s]  2%|‚ñè         | 78/3240 [01:20<42:43,  1.23it/s]  2%|‚ñè         | 79/3240 [01:20<40:36,  1.30it/s]  2%|‚ñè         | 80/3240 [01:21<39:00,  1.35it/s]                                                   2%|‚ñè         | 80/3240 [01:21<39:00,  1.35it/s]  2%|‚ñé         | 81/3240 [01:24<1:12:30,  1.38s/it]  3%|‚ñé         | 82/3240 [01:25<1:01:17,  1.16s/it]  3%|‚ñé         | 83/3240 [01:25<53:33,  1.02s/it]    3%|‚ñé         | 84/3240 [01:26<47:56,  1.10it/s]  3%|‚ñé         | 85/3240 [01:27<44:05,  1.19it/s]  3%|‚ñé         | 86/3240 [01:27<41:23,  1.27it/s]  3%|‚ñé         | 87/3240 [01:28<39:34,  1.33it/s]  3%|‚ñé         | 88/3240 [01:29<38:11,  1.38it/s]  3%|‚ñé         | 89/3240 [01:32<1:11:39,  1.36s/it]  3%|‚ñé         | 90/3240 [01:32<1:00:36,  1.15s/it]  3%|‚ñé         | 91/3240 [01:33<52:57,  1.01s/it]    3%|‚ñé         | 92/3240 [01:34<47:29,  1.10it/s]  3%|‚ñé         | 93/3240 [01:34<43:40,  1.20it/s]  3%|‚ñé         | 94/3240 [01:35<40:59,  1.28it/s]  3%|‚ñé         | 95/3240 [01:36<39:08,  1.34it/s]  3%|‚ñé         | 96/3240 [01:36<37:54,  1.38it/s]  3%|‚ñé         | 97/3240 [01:39<1:15:00,  1.43s/it]  3%|‚ñé         | 98/3240 [01:40<1:03:04,  1.20s/it]  3%|‚ñé         | 99/3240 [01:41<54:37,  1.04s/it]    3%|‚ñé         | 100/3240 [01:41<48:44,  1.07it/s]                                                    3%|‚ñé         | 100/3240 [01:41<48:44,  1.07it/s]  3%|‚ñé         | 101/3240 [01:42<44:39,  1.17it/s]  3%|‚ñé         | 102/3240 [01:43<41:52,  1.25it/s]  3%|‚ñé         | 103/3240 [01:43<39:49,  1.31it/s]  3%|‚ñé         | 104/3240 [01:44<38:20,  1.36it/s]  3%|‚ñé         | 105/3240 [01:47<1:11:44,  1.37s/it]  3%|‚ñé         | 106/3240 [01:48<1:00:39,  1.16s/it]  3%|‚ñé         | 107/3240 [01:48<52:54,  1.01s/it]    3%|‚ñé         | 108/3240 [01:49<47:30,  1.10it/s]  3%|‚ñé         | 109/3240 [01:50<43:43,  1.19it/s]  3%|‚ñé         | 110/3240 [01:50<41:04,  1.27it/s]  3%|‚ñé         | 111/3240 [01:51<39:13,  1.33it/s]  3%|‚ñé         | 112/3240 [01:52<37:54,  1.38it/s]  3%|‚ñé         | 113/3240 [01:54<1:11:15,  1.37s/it]  4%|‚ñé         | 114/3240 [01:55<1:00:14,  1.16s/it]  4%|‚ñé         | 115/3240 [01:56<52:33,  1.01s/it]    4%|‚ñé         | 116/3240 [01:56<47:11,  1.10it/s]  4%|‚ñé         | 117/3240 [01:57<43:29,  1.20it/s]  4%|‚ñé         | 118/3240 [01:58<40:48,  1.28it/s]  4%|‚ñé         | 119/3240 [01:58<38:59,  1.33it/s]  4%|‚ñé         | 120/3240 [01:59<37:39,  1.38it/s]                                                    4%|‚ñé         | 120/3240 [01:59<37:39,  1.38it/s]  4%|‚ñé         | 121/3240 [02:02<1:12:05,  1.39s/it]  4%|‚ñç         | 122/3240 [02:03<1:01:40,  1.19s/it]  4%|‚ñç         | 123/3240 [02:03<54:14,  1.04s/it]    4%|‚ñç         | 124/3240 [02:04<49:05,  1.06it/s]  4%|‚ñç         | 125/3240 [02:05<45:31,  1.14it/s]  4%|‚ñç         | 126/3240 [02:06<43:02,  1.21it/s]  4%|‚ñç         | 127/3240 [02:06<41:16,  1.26it/s]  4%|‚ñç         | 128/3240 [02:07<40:01,  1.30it/s]  4%|‚ñç         | 129/3240 [02:10<1:12:43,  1.40s/it]  4%|‚ñç         | 130/3240 [02:11<1:01:25,  1.18s/it]  4%|‚ñç         | 131/3240 [02:11<53:31,  1.03s/it]    4%|‚ñç         | 132/3240 [02:12<47:59,  1.08it/s]  4%|‚ñç         | 133/3240 [02:13<44:06,  1.17it/s]  4%|‚ñç         | 134/3240 [02:13<41:23,  1.25it/s]{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 5.864197530864198e-07, 'num_tokens': 2420.0, 'completions/mean_length': 118.44444529215495, 'completions/min_length': 70.66666666666667, 'completions/max_length': 128.0, 'completions/clipped_ratio': 0.888888888888889, 'completions/mean_terminated_length': 28.0, 'completions/min_terminated_length': 28.0, 'completions/max_terminated_length': 28.0, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'epoch': 0.02}
{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 1.2037037037037037e-06, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'num_tokens': 4202.0, 'completions/mean_length': 128.0, 'completions/min_length': 128.0, 'completions/max_length': 128.0, 'completions/clipped_ratio': 1.0, 'completions/mean_terminated_length': 0.0, 'completions/min_terminated_length': 0.0, 'completions/max_terminated_length': 0.0, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'epoch': 0.04}
{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 1.820987654320988e-06, 'num_tokens': 6556.0, 'completions/mean_length': 114.11111195882161, 'completions/min_length': 91.0, 'completions/max_length': 128.0, 'completions/clipped_ratio': 0.7777777777777778, 'completions/mean_terminated_length': 21.833333333333332, 'completions/min_terminated_length': 5.666666666666667, 'completions/max_terminated_length': 39.0, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'epoch': 0.06}
{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 2.438271604938272e-06, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'num_tokens': 8177.0, 'completions/mean_length': 122.58333587646484, 'completions/min_length': 95.5, 'completions/max_length': 128.0, 'completions/clipped_ratio': 0.9166666666666667, 'completions/mean_terminated_length': 31.5, 'completions/min_terminated_length': 31.5, 'completions/max_terminated_length': 31.5, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'epoch': 0.07}
{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 3.055555555555556e-06, 'num_tokens': 10733.0, 'completions/mean_length': 128.0, 'completions/min_length': 128.0, 'completions/max_length': 128.0, 'completions/clipped_ratio': 1.0, 'completions/mean_terminated_length': 0.0, 'completions/min_terminated_length': 0.0, 'completions/max_terminated_length': 0.0, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'epoch': 0.09}
{'loss': 0.0, 'grad_norm': 0.0, 'learning_rate': 3.67283950617284e-06, 'kl': 0.0, 'clip_ratio/low_mean': 0.0, 'clip_ratio/low_min': 0.0, 'clip_ratio/high_mean': 0.0, 'clip_ratio/high_max': 0.0, 'clip_ratio/region_mean': 0.0, 'num_tokens': 12425.0, 'completions/mean_length': 128.0, 'completions/min_length': 128.0, 'completions/max_length': 128.0, 'completions/clipped_ratio': 1.0, 'completions/mean_terminated_length': 0.0, 'completions/min_terminated_length': 0.0, 'completions/max_terminated_length': 0.0, 'rewards/reward_one_type_only/mean': 0.0, 'rewards/reward_one_type_only/std': 0.0, 'reward': 0.0, 'reward_std': 0.0, 'epoch': 0.11}
Traceback (most recent call last):
  File "/playpen/hongxuan/drug_repurpose/grpo_startup/grpo_train.py", line 99, in <module>
    trainer.train()
  File "/home/swyun/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/swyun/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2565, in _inner_training_loop
    and (torch.isnan(tr_loss_step) or torch.isinf(tr_loss_step))
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7f4a70d61f80>
Traceback (most recent call last):
  File "/home/swyun/.local/lib/python3.12/site-packages/wandb/sdk/lib/service_connection.py", line 94, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/home/swyun/.local/lib/python3.12/site-packages/wandb/sdk/lib/service_connection.py", line 226, in teardown
    self._router.join()
  File "/home/swyun/.local/lib/python3.12/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/home/swyun/miniconda3/lib/python3.12/threading.py", line 1147, in join
    self._wait_for_tstate_lock()
  File "/home/swyun/miniconda3/lib/python3.12/threading.py", line 1167, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt: 
